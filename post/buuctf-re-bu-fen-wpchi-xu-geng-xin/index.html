<html>
  <head>
    <meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>BUUCTF re部分wp（持续更新） | 7usai</title>
<link rel="shortcut icon" href="https://7usai.github.io/favicon.ico?v=1597677549438">
<link href="https://cdn.jsdelivr.net/npm/remixicon@2.3.0/fonts/remixicon.css" rel="stylesheet">
<link rel="stylesheet" href="https://7usai.github.io/styles/main.css">
<link rel="alternate" type="application/atom+xml" title="BUUCTF re部分wp（持续更新） | 7usai - Atom Feed" href="https://7usai.github.io/atom.xml">
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Droid+Serif:400,700">



    <meta name="description" content="BUUCTF re部分wp
easyre

reverse1
搜索flag字符串找到如下位置

再按F5后再双击Str2

将hello_world中的o换成0
得flag{hell0_w0rld}
reverse2
找到main函数按下F..." />
    <meta name="keywords" content="CTF,二进制" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.10.0/katex.min.css">
    <script src="https://cdn.bootcss.com/highlight.js/9.12.0/highlight.min.js"></script>
  </head>
  <body>
    <div class="main">
      <div class="main-content">
        <div class="site-header">
  <a href="https://7usai.github.io">
  <img class="avatar" src="https://7usai.github.io/images/avatar.png?v=1597677549438" alt="">
  </a>
  <h1 class="site-title">
    7usai
  </h1>
  <p class="site-description">
    7usai'blog
  </p>
  <div class="menu-container">
    
      
        <a href="/" class="menu">
          首页
        </a>
      
    
      
        <a href="/archives" class="menu">
          归档
        </a>
      
    
      
        <a href="/tags" class="menu">
          标签
        </a>
      
    
      
        <a href="/post/about" class="menu">
          关于
        </a>
      
    
  </div>
  <div class="social-container">
    
      
        <a href="https://github.com/7usai" target="_blank">
          <i class="ri-github-line"></i>
        </a>
      
    
      
    
      
    
      
    
      
    
  </div>
</div>

        <div class="post-detail">
          <article class="post">
            <h2 class="post-title">
              BUUCTF re部分wp（持续更新）
            </h2>
            <div class="post-info">
              <span>
                2020-07-31
              </span>
              <span>
                5 min read
              </span>
              
                <a href="https://7usai.github.io/tag/_wk3DR6W6/" class="post-tag">
                  # CTF
                </a>
              
                <a href="https://7usai.github.io/tag/7xbgN0lBu/" class="post-tag">
                  # 二进制
                </a>
              
            </div>
            
            <div class="post-content-wrapper">
              <div class="post-content">
                <h1 id="buuctf-re部分wp">BUUCTF re部分wp</h1>
<h2 id="easyre">easyre</h2>
<figure data-type="image" tabindex="1"><img src="https://7usai.github.io/post-images/1596204910229.png" alt="" loading="lazy"></figure>
<h2 id="reverse1">reverse1</h2>
<p>搜索flag字符串找到如下位置<br>
<img src="https://7usai.github.io/post-images/1596204953682.png" alt="" loading="lazy"></p>
<p>再按F5后再双击Str2<br>
<img src="https://7usai.github.io/post-images/1596204960649.png" alt="" loading="lazy"></p>
<p>将hello_world中的o换成0</p>
<p>得flag{hell0_w0rld}</p>
<h2 id="reverse2">reverse2</h2>
<p>找到main函数按下F5<br>
<img src="https://7usai.github.io/post-images/1596204969585.png" alt="" loading="lazy"></p>
<p>双击flag</p>
<p><img src="https://7usai.github.io/post-images/1596204975899.png" alt="" loading="lazy"><br>
输入发现不正确继续看</p>
<p>这里flag中存的是{hacking_for_fun}</p>
<figure data-type="image" tabindex="2"><img src="https://7usai.github.io/post-images/1596204985974.png" alt="" loading="lazy"></figure>
<p>在主函数的这里发生了转换，查ascii表得是将i和r转换成1</p>
<p>得flag{hack1ng_fo1_fun}</p>
<h2 id="新年快乐">新年快乐</h2>
<p>有UPX壳，脱壳后找</p>
<figure data-type="image" tabindex="3"><img src="https://7usai.github.io/post-images/1596204992819.png" alt="" loading="lazy"></figure>
<h2 id="内涵的软件">内涵的软件</h2>
<p>拖进IDA得flag,DBAPP换成flag<br>
<img src="https://7usai.github.io/post-images/1596205001874.png" alt="" loading="lazy"></p>
<h2 id="bjdctf-2ndguessgame">[BJDCTF 2nd]guessgame</h2>
<p>shift+F12得flag</p>
<figure data-type="image" tabindex="4"><img src="https://7usai.github.io/post-images/1596211165409.png" alt="" loading="lazy"></figure>
<h2 id="helloword">helloword</h2>
<p>得到一个APK文件</p>
<p>放入android killer里边得flag<br>
<img src="https://7usai.github.io/post-images/1596211279124.png" alt="" loading="lazy"></p>
<h2 id="xor">XOR</h2>
<p>看main函数应该是一个33位数异或<br>
<img src="https://7usai.github.io/post-images/1596211286748.png" alt="" loading="lazy"></p>
<figure data-type="image" tabindex="5"><img src="https://7usai.github.io/post-images/1596211291028.png" alt="" loading="lazy"></figure>
<p>这里有33位数</p>
<p>写异或算法</p>
<pre><code>l=[0x66,0x0a,0x6b,0x0c,0x77,0x26,0x4f,0x2e,0x40,0x11,0x78,0x0d,0x5a,0x3b,0x55,0x11,0x70,0x19,0x46,0x1f,0x76,0x22,0x4d,0x23,0x44,0x0e,0x67,0x06,0x68,0x0f,0x47,0x32,0x4f]
x='f'
for i in range(1,len(l)):
    x+=chr(l[i]^l[i-1])
    print (x)
</code></pre>
<p>得flag<br>
<img src="https://7usai.github.io/post-images/1596211295525.png" alt="" loading="lazy"></p>
<h2 id="reverse3">reverse3</h2>
<p>32位IDA打开 找到main函数为sub_4156E0</p>
<figure data-type="image" tabindex="6"><img src="https://7usai.github.io/post-images/1596231374547.png" alt="" loading="lazy"></figure>
<p>Dest与Str2比较，相等则为加密的flag。首先我们输入flag值，flag值经过变换后得Dest，即Str2。</p>
<p>flag先变为v1,再变为Dest1，再变为Dest（Str2）</p>
<p>找到v1转换函数</p>
<figure data-type="image" tabindex="7"><img src="https://7usai.github.io/post-images/1596231379288.png" alt="" loading="lazy"></figure>
<figure data-type="image" tabindex="8"><img src="https://7usai.github.io/post-images/1596231383733.png" alt="" loading="lazy"></figure>
<p>可见是base64加密</p>
<p>又得到Str2的值</p>
<figure data-type="image" tabindex="9"><img src="https://7usai.github.io/post-images/1596231387805.png" alt="" loading="lazy"></figure>
<p>编写脚本</p>
<pre><code>import base64
str2='e3nifIH9b_C@n@dH'
x=''
for i in range(0,len(str2)):
    x+=chr(ord(str2[i])-i)
print (x)
y=base64.b64decode(x)
print (y)
</code></pre>
<p>得flag</p>
<figure data-type="image" tabindex="10"><img src="https://7usai.github.io/post-images/1596231394662.png" alt="" loading="lazy"></figure>
<p>补充</p>
<p>ord()函数主要用来返回对应字符的ascii码，chr()主要用来表示ascii码对应的字符他的输入时数字（可十进制可十六进制），ord:字符转ascii码，chr:ascii码转字符。在此题计算中先转为ascii减数字，得到的新ascii再转为字符。</p>
<p>python中base64加密与解码，加密用encode解密用decode，如下例</p>
<p>&gt;&gt;&gt; import base64<br>
&gt;&gt;&gt; s = '我是字符串'<br>
&gt;&gt;&gt; a = base64.b64encode(s)<br>
&gt;&gt;&gt; print a<br>
ztLKx9fWt/u0rg==<br>
&gt;&gt;&gt; print base64.b64decode(a)<br>
我是字符串</p>
<h2 id="不一样的flag">不一样的flag</h2>
<figure data-type="image" tabindex="11"><img src="https://7usai.github.io/post-images/1596232291308.png" alt="" loading="lazy"></figure>
<p>点开程序是这样，放入IDA32位得主函数</p>
<figure data-type="image" tabindex="12"><img src="https://7usai.github.io/post-images/1596232295572.png" alt="" loading="lazy"></figure>
<p>又查到此字符串，猜测是个迷宫题</p>
<figure data-type="image" tabindex="13"><img src="https://7usai.github.io/post-images/1596232300989.png" alt="" loading="lazy"></figure>
<p>这里的意思时遇到1就退出，即不遇到1的情况下到达#<br>
<img src="https://7usai.github.io/post-images/1596232306563.png" alt="" loading="lazy"></p>
<p>*11110100001010000101111#可分为5行 *为起点#为重点</p>
<pre><code>*1111
01000
01010
00010
1111#
</code></pre>
<p>于是走一遍得</p>
<p>flag{222441144222}</p>
<h2 id="simplerev">SimpleRev</h2>
<figure data-type="image" tabindex="14"><img src="https://7usai.github.io/post-images/1597677451168.png" alt="" loading="lazy"></figure>
<p>这里表示得到v4，v4为d或者D时进入Decry函数，不为d或者D时判断是否为Q或者q，是的话退出，不是则输出错误。<br>
<img src="https://7usai.github.io/post-images/1597677458757.png" alt="" loading="lazy"></p>
<p>进入Decry得到text通过key3，v9和join函数得到，进入join函数</p>
<figure data-type="image" tabindex="15"><img src="https://7usai.github.io/post-images/1597677466006.png" alt="" loading="lazy"></figure>
<p>意思是a1与a2连接，返回值dest=a1+a2。<br>
回到Decry函数可知text=key3+v9。key=key1+src。</p>
<figure data-type="image" tabindex="16"><img src="https://7usai.github.io/post-images/1597677474689.png" alt="" loading="lazy"></figure>
<p>key3=kills,key1=ADSFK，因为是小端序存储，所以text=killshadow，key=ADSFKNDCLS</p>
<figure data-type="image" tabindex="17"><img src="https://7usai.github.io/post-images/1597677480466.png" alt="" loading="lazy"></figure>
<p>这一步是将大写字母变为小写字母，key=adsfkndcls</p>
<p><img src="https://7usai.github.io/post-images/1597677488135.png" alt="" loading="lazy"><br>
编写脚本</p>
<pre><code>key=&quot;adsfkndcls&quot;
text=&quot;killshadow&quot;
loop=&quot;ABCDEFGHIJKLMNOPQRSTUVWXYZ&quot;
flag=&quot;&quot;
for i in range(0,len(text)):
    for j in loop:
        if ord(text[i])==(ord(j)-39-ord(key[i])+97)%26+97:
            flag+=j
print(flag)
</code></pre>
<p>得到flag</p>
<p>KLDQCUDFZO</p>
<h2 id="刮开有奖">刮开有奖</h2>
<figure data-type="image" tabindex="18"><img src="https://7usai.github.io/post-images/1597677495395.png" alt="" loading="lazy"></figure>
<p>找到主函数DialogFunc并进入可知v7是数组的开头第一位，进入sub_4010F0</p>
<figure data-type="image" tabindex="19"><img src="https://7usai.github.io/post-images/1597677500492.png" alt="" loading="lazy"></figure>
<p>转为c语音代码得</p>
<pre><code>#include &lt;iostream&gt;
using namespace std;
int f(char arr[], int a, int b)
{
    int result;
    int i;
    int v5;
    int v6;
    result = b;
    for (i = a; i &lt;= b; a = i)
    {
        v5 = i;
        v6 = arr[i];
        if (a &lt; result &amp;&amp; i &lt; result)
        {
            do
            {
                if (v6 &gt; arr[result])
                {
                    if (i &gt;= result)
                        break;
                    ++i;
                    arr[v5] = arr[result];
                    if (i &gt;= result)
                        break;
                    while (arr[i] &lt;= v6)
                    {
                        if (++i &gt;= result)
                            goto LABEL_13;
                    }
                    if (i&gt;=result)
                        break;
                    v5 = i;
                    arr[result] = arr[i];
                }
                --result;
            } while (i &lt; result);
        }
LABEL_13:
        arr[result] = v6;
        f(arr, a, i - 1);
        result = b;
        ++i;
    }
    return result;
}
int main()
{
    char arr[20] = {90, 74, 83, 69, 67, 97, 78, 72, 51, 110, 103};
    cout &lt;&lt; arr &lt;&lt; endl;
    f(arr,0,10);
    cout&lt;&lt;arr&lt;&lt;endl;
    return 0;
}
</code></pre>
<p>运行一下得</p>
<figure data-type="image" tabindex="20"><img src="https://7usai.github.io/post-images/1597677510196.png" alt="" loading="lazy"></figure>
<p>进入401000函数可看出事base64</p>
<figure data-type="image" tabindex="21"><img src="https://7usai.github.io/post-images/1597677516740.png" alt="" loading="lazy"></figure>
<figure data-type="image" tabindex="22"><img src="https://7usai.github.io/post-images/1597677522324.png" alt="" loading="lazy"></figure>
<p>这里第一位是U第二位J第三位开始通过ak1w,V1ax解码得jMp和WP1所以从第三位开始是WP1jMp</p>
<p>拼得flag{UJWP1jMp}</p>

              </div>
              <div class="toc-container">
                <ul class="markdownIt-TOC">
<li><a href="#buuctf-re%E9%83%A8%E5%88%86wp">BUUCTF re部分wp</a>
<ul>
<li><a href="#easyre">easyre</a></li>
<li><a href="#reverse1">reverse1</a></li>
<li><a href="#reverse2">reverse2</a></li>
<li><a href="#%E6%96%B0%E5%B9%B4%E5%BF%AB%E4%B9%90">新年快乐</a></li>
<li><a href="#%E5%86%85%E6%B6%B5%E7%9A%84%E8%BD%AF%E4%BB%B6">内涵的软件</a></li>
<li><a href="#bjdctf-2ndguessgame">[BJDCTF 2nd]guessgame</a></li>
<li><a href="#helloword">helloword</a></li>
<li><a href="#xor">XOR</a></li>
<li><a href="#reverse3">reverse3</a></li>
<li><a href="#%E4%B8%8D%E4%B8%80%E6%A0%B7%E7%9A%84flag">不一样的flag</a></li>
<li><a href="#simplerev">SimpleRev</a></li>
<li><a href="#%E5%88%AE%E5%BC%80%E6%9C%89%E5%A5%96">刮开有奖</a></li>
</ul>
</li>
</ul>

              </div>
            </div>
          </article>
        </div>

        
          <div class="next-post">
            <div class="next">下一篇</div>
            <a href="https://7usai.github.io/post/typora-kuai-jie-jian/">
              <h3 class="post-title">
                Typora快捷键
              </h3>
            </a>
          </div>
        

        

        <div class="site-footer">
  Powered by <a href="https://github.com/getgridea/gridea" target="_blank">Gridea</a>
  <a class="rss" href="https://7usai.github.io/atom.xml" target="_blank">
    <i class="ri-rss-line"></i> RSS
  </a>
</div>

      </div>
    </div>

    <script>
      hljs.initHighlightingOnLoad()

      let mainNavLinks = document.querySelectorAll(".markdownIt-TOC a");

      // This should probably be throttled.
      // Especially because it triggers during smooth scrolling.
      // https://lodash.com/docs/4.17.10#throttle
      // You could do like...
      // window.addEventListener("scroll", () => {
      //    _.throttle(doThatStuff, 100);
      // });
      // Only not doing it here to keep this Pen dependency-free.

      window.addEventListener("scroll", event => {
        let fromTop = window.scrollY;

        mainNavLinks.forEach((link, index) => {
          let section = document.getElementById(decodeURI(link.hash).substring(1));
          let nextSection = null
          if (mainNavLinks[index + 1]) {
            nextSection = document.getElementById(decodeURI(mainNavLinks[index + 1].hash).substring(1));
          }
          if (section.offsetTop <= fromTop) {
            if (nextSection) {
              if (nextSection.offsetTop > fromTop) {
                link.classList.add("current");
              } else {
                link.classList.remove("current");    
              }
            } else {
              link.classList.add("current");
            }
          } else {
            link.classList.remove("current");
          }
        });
      });

    </script>
  </body>
</html>
